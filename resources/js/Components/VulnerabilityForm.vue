<template>
    <form @submit.prevent="submit">
        <o-field label="Title" :variant="errors?.title ? 'danger' : ''" :message="errors?.title">
            <o-input v-model="form.title"></o-input>
        </o-field>
        <o-field label="Description" :variant="errors?.description ? 'danger' : ''" :message="errors?.description">
            <o-input v-model="form.description" type="textarea"></o-input>
        </o-field>
        <o-field label="More Info (url)" :variant="errors?.url ? 'danger' : ''" :message="errors?.url">
            <o-input v-model="form.url"></o-input>
        </o-field>
        <o-button tag="input" native-type="submit" :value="buttonLabel" />
    </form>
</template>

<script>
import { useForm } from '@inertiajs/inertia-vue3'
export default {
    props: {
        errors: {
            type: Object,
            default: null
        },
        existing: {
            type: Object,
            default: null
        },
        buttonLabel: {
            type: String,
            default: ''
        },
        route: {
            type: String,
            default: null
        }
    },
    setup (props) {
        const form = useForm({
            title: props?.existing?.title,
            description: props?.existing?.description,
            url: props?.existing?.url,
        })
        function submit() {
            form.post(props.route, {
                onSuccess: () => window.location.href = '/'
            })
        }
        return { form, submit }
    },
}
</script>
